<html>

<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <style>
        pre {
            outline: 1px solid #ccc;
            padding: 5px;
            margin: 5px;
        }

        .string {
            color: green;
        }

        .number {
            color: darkorange;
        }

        .boolean {
            color: blue;
        }

        .null {
            color: magenta;
        }

        .key {
            color: red;
        }
    </style>
</head>

<body>
    

    <div class="container">
            <h1>
                    Full Text Address Search
                </h1>
        <div class="row">
            
            <div class="col-sm">
                <label for="basic-url">ที่อยู่</label>
                <div class="input-group">
                    <textarea onchange="search(this.value)" class="form-control" aria-label="With textarea"></textarea>
                </div>
            </div>
            <div class="col-sm">
                <label for="basic-url">ผลลัพท์</label>
                <div id="jsonRender"></div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.0.4/fuse.min.js"></script>
    <script src="https://7elven.github.io/js/fullTextSearchAddress/fullTextSearchAddress.min.js"></script>
    <script>
        function search(text) {
            var render = document.getElementById('jsonRender')
            render.innerHTML = ""

            fullTextSearchAddress(text,{
                zipFilter:true,
                limit:10
            }).then(data => {
                console.log(data)
                output(syntaxHighlight(JSON.stringify(data, undefined, 4)))
            })
        }

        // ---------------------- highlight json --------------------------
        function output(json) {
            var element = document.getElementById('jsonRender')
            element.appendChild(document.createElement('pre')).innerHTML = json;
        }

        function syntaxHighlight(json) {
            json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
            return json.replace(
                /("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,
                function (match) {
                    var cls = 'number';
                    if (/^"/.test(match)) {
                        if (/:$/.test(match)) {
                            cls = 'key';
                        } else {
                            cls = 'string';
                        }
                    } else if (/true|false/.test(match)) {
                        cls = 'boolean';
                    } else if (/null/.test(match)) {
                        cls = 'null';
                    }
                    return '<span class="' + cls + '">' + match + '</span>';
                });
        }
    </script>
</body>

</html>